# 人员字段分级与字段集（含角色包与临时授权）

本文件将《人员信息字段.md》进行分级与分组，并用于“系统数据可见性”的统一规则；同时合并权限与角色包、临时访问授权，并结合《部门及负责人信息.md》的组织架构。并落实以下策略：联系方式仅“工作邮箱”全员可见，其余需管理员授权；“假期余额”仅 HR 可见。

---

## 1. 字段分级

分为四级（可在管理端配置维护）：
- 公开：企业内部全员可见（仍受组织可见性限制）
- 内部：仅内部使用，受范围控制（部门/事业部等），默认不对外
- 敏感：默认仅HR或被授权管理员可见，导出需授权
- 极敏感：仅特定授权人员可见/下载/导出

参考映射（初始建议，后续以配置为准）：
- 公开：姓名、部门、职务/岗位、工作邮箱、座机、企业内展示字段
- 内部：性别、出生日期、年龄、身高、体重、血型、国籍、民族、政治面貌、籍贯、户籍信息、教育经历（不含证件编号类）、联系方式（手机/微信/QQ/个人Email）、工作经历（公司/部门/职务/起止）、人员状态/人员类型/序列、入职/转正/实习转正/试用期(月)、工作地点、入职办理地点、标签
- 敏感：现居住地址、身份证地址、以往病史（健康信息）、紧急联系人（含住址/电话）、家庭成员（含联系方式/单位）、入职时社保状况、工龄/司龄/首次参加工作日期/工龄计算使用日期、合同信息（全量）、假期余额
- 极敏感：证件信息（类型/号码/有效期/到期剩余）、银行卡信息（开户人/开户支行/卡号）、资料附件（身份证、银行卡、户口本、学历/学位证书、离职证明、体检报告、学生证、性格测试等）

---

## 2. 字段集（用于页面/接口场景）

以场景组合字段，便于前后端一致复用：
- 组织信息集：公司、事业部、事业部负责人、部门、直属上级、岗位/序列、所属公司、工作地点、入职办理地点、序列
- 企业内展示集：姓名、部门、职务、工作邮箱、座机
- 联系方式集（内部）：手机、微信、QQ、个人Email（默认仅本人可见；他人查看需管理员授权）
- 对外展示集：企业、实名、别名、手机、地址、邮箱、对外职务、朋友圈、企业名片、视频号、我的业务
- 假勤信息集（内部）：假期余额（仅HR可见）
- 事业部负责人查看集（建议）：公开 + 组织信息集 + 部分内部（工号、在职状态、入职日期）
- 部门负责人查看集（建议）：公开 + 组织信息集 + 部分内部（工号、在职状态、入职日期、直属上级）
- 员工自改集（白名单）：姓名、别名、手机、头像、性别、座机、地址、对外职务、视频号、直属上级（可配置）
- HR敏感查看集：敏感 + 极敏感（受授权矩阵约束）

说明：以上集合可在管理端动态配置，文档仅为初始模板。

---

## 3. 系统数据可见性（基于组织与负责人）

全系统统一使用以下规则（优先级自上而下）：
1) 隐藏的部门/成员：不可见、不可搜索；
2) 限制查看所有人：仅能看自己；
3) 限制查看外部门：仅看本部门（可选是否含下属团队）；
4) 硬边界：公司为默认硬边界；事业部不作为硬边界（当前关闭，作为范围标签使用）；
5) 角色与字段分级：按第4节权限策略判定具体可见字段。

负责人派生的数据范围：
6) 事业部负责人：默认数据范围=本事业部（含其下属部门）；
7) 部门负责人：默认数据范围=本部门（含其下属小组/团队）；
8) 多重负责人：若同时负责多个事业部/部门，数据范围取并集；
9) 组织树与负责人关系以《部门及负责人信息.md》为准。
10) 联系方式可见性：仅“工作邮箱”全员可见；手机号/个人邮箱/微信/QQ对他人不可见，需管理员授权；本人始终可见。
11) 假期余额可见性：仅HR可见；默认不允许下载/导出（如需另行授权，请在矩阵中配置）。

---

## 4. 权限与角色包（含临时访问授权）

角色：
- 超级管理员：拥有一切权限；唯一能分配/回收管理员权限的人。
- 管理员：默认无权限，仅能通过超级管理员分配“权限包”。

权限包（可勾选获得）：
- 人员资料管理包：查看/新增/编辑人员档案（排除极敏感）。
- HR敏感资料包：查看/编辑敏感与极敏感字段/附件；可配置下载/导出权限。
- 组织可见性配置包：维护隐藏/限制/排序、成员自改白名单、对外字段配置。
- 组织架构管理包：公司/事业部/部门/岗位/上级关系维护。
- 审批管理包：审批流定义与处理（如访问申请、导出申请）。
- 导出与报表包：导出通讯录/人员报表。

数据范围：全公司 / 本事业部 / 本部门（含下属） / 本人/直属下属 / 指定标签。

负责人默认权限（基线，仍受敏感/极敏感授权约束）：
- 事业部负责人：范围=本事业部；动作=查看；字段集=“事业部负责人查看集”；
- 部门负责人：范围=本部门（含下属）；动作=查看；字段集=“部门负责人查看集”。

临时访问授权：
- 维度：被授权人/组 × 字段或附件类型 × 数据范围 × 动作（查看/下载/导出） × 时效；
- 可选择允许跨公司/事业部边界；到期自动失效；记录最小化授权信息用于判定（当前阶段不启用审计日志）。

---

## 5. 前后端对齐建议

- 后端提供：
  - canAccess(user, action, resource, target, field?)：返回可见与可操作字段集合；
  - 统一应用隐藏/限制/硬边界/角色包/字段分级/临时授权。
- 前端：
  - 按后端返回的可见字段渲染；不可见字段隐藏或脱敏；
  - 导出/下载入口按后端可操作集合与临时授权生效状态控制。

---

## 6. 后续可维护项

- 将本文件中的字段分级与字段集，沉淀为可配置表（UI管理）；
- 输出CSV模板，便于初始化导入；
- 若未来启用审计，再补充审计事件字典与留存策略。


---

## 进度

- 字段分级与字段集：已完成并落库（Prisma 模型 `FieldDefinition/FieldSet/FieldSetItem` 已创建，最小字段集已种子初始化）。
- 组织与负责人：已在《部门及负责人信息.md》维护，后续映射到配置表。
- 可见性策略：已在《人员管理—权限与可见性方案.md》对齐，待前端按可见字段渲染。
 - 接入情况：后端用户详情/列表/导出已按字段集与分级进行可见性控制（联系方式示例）。
 - 临时访问授权：已接入（MVP），支持按字段/时效临时放行。



---

## 附录：字段 key 与中文名映射（MVP）

| key | 中文名 |
|---|---|
| `name` | 姓名 |
| `department` | 部门 |
| `position` | 职务/岗位 |
| `landline` | 座机 |
| `contact_work_email` | 工作邮箱 |
| `contact_phone` | 手机号码 |
| `contact_wechat` | 微信 |
| `contact_qq` | QQ |
| `contact_personal_email` | 个人邮箱 |
| `employee_no` | 工号 |
| `employment_status` | 在职状态 |
| `join_date` | 入职日期 |
| `vacation_balance` | 假期余额 |
| `id_number` | 证件号码 |
| `bank_card_number` | 银行卡号 |
| `document_id_card` | 身份证附件 |

说明：如需新增字段，请在管理端维护字段定义（key、label、分级、自改可否），并按需加入对应字段集。


